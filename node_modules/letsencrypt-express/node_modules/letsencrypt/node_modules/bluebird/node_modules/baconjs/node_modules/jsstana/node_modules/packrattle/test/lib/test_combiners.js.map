{"version":3,"sources":["../src/test_combiners.js"],"names":[],"mappings":"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","file":"test_combiners.js","sourcesContent":["\"use strict\";\n\nimport pr from \"../../lib\";\n\nrequire(\"should\");\nrequire(\"source-map-support\").install();\n\ndescribe(\"combiners\", () => {\n  it(\"chain\", () => {\n    const p = pr.chain(\"abc\", \"123\", (a, b) => b + a);\n    (() => p.run(\"123\")).should.throw(/'abc'/);\n    p.run(\"abc123\").should.eql(\"123abc\");\n  });\n\n  it(\"parser.then\", () => {\n    const p = pr.string(\"abc\").then(pr.string(\"123\"));\n    let rv = p.execute(\"abc123\");\n    rv.ok.should.eql(true);\n    rv.state.pos.should.equal(6);\n    rv.value.should.eql([ \"abc\", \"123\" ]);\n    rv = p.execute(\"abcd\");\n    rv.ok.should.eql(false);\n    rv.state.pos.should.equal(3);\n    rv.value.should.match(/123/);\n    rv = p.execute(\"123\")\n    rv.ok.should.eql(false);\n    rv.state.pos.should.equal(0);\n    rv.value.should.match(/abc/);\n  });\n\n  // seq tests are in test_seq.js.\n\n  it(\"alt\", () => {\n    const p = pr.alt(\"hello\", \"goodbye\");\n    (() => p.run(\"cat\")).should.throw(/'hello'/);\n    p.run(\"hello\").should.eql(\"hello\");\n    p.run(\"goodbye\").should.eql(\"goodbye\");\n  });\n\n  it(\"parser.or\", () => {\n    const p = pr.string(\"hello\").or(pr.string(\"goodbye\"));\n    (() => p.run(\"cat\")).should.throw(/'hello'/);\n    p.run(\"hello\").should.eql(\"hello\");\n    p.run(\"goodbye\").should.eql(\"goodbye\");\n  });\n\n  it(\"drop\", () => {\n    const p = pr.drop(\"abc\");\n    let m = p.execute(\"abc\");\n    m.state.pos.should.eql(3);\n    (m.value == null).should.eql(true);\n  });\n\n  it(\"parser.drop\", () => {\n    const p = pr(\"abc\").drop();\n    let m = p.execute(\"abc\");\n    m.state.pos.should.eql(3);\n    (m.value == null).should.eql(true);\n  });\n\n  describe(\"optional\", () => {\n    it(\"optional\", () => {\n      const p = pr.optional(/\\d+/, \"?\");\n      let m = p.execute(\"34.\");\n      m.state.pos.should.eql(2);\n      m.value[0].should.eql(\"34\");\n      m = p.execute(\"no\");\n      m.state.pos.should.eql(0);\n      m.value.should.eql(\"?\");\n    });\n\n    it(\"parser.optional\", () => {\n      const p = pr(/\\d+/).optional(\"?\");\n      let m = p.execute(\"34.\");\n      m.state.pos.should.eql(2);\n      m.value[0].should.eql(\"34\");\n      m = p.execute(\"no\");\n      m.state.pos.should.eql(0);\n      m.value.should.eql(\"?\");\n    });\n\n    it(\"advances position correctly past an optional\", () => {\n      const p = pr([\n        /[b]+/,\n        pr(/c/).optional().map((m, span) => ({ start: span.start, end: span.end })),\n        pr(/[d]+/)\n      ]);\n      const rv = p.execute(\"bbbd\");\n      rv.ok.should.eql(true);\n      rv.value[1].should.eql({ start: 3, end: 4 });\n      rv.value[2][0].should.eql(\"d\");\n    });\n\n    it(\"tries both the success and failure sides\", () => {\n      const p = pr([\n        pr.optional(/\\d+/),\n        pr.alt(\n          \"z\",\n          \"9y\"\n        )\n      ]);\n      const rv1 = p.execute(\"33z\");\n      rv1.ok.should.eql(true);\n      rv1.value[1].should.eql(\"z\");\n      const rv2 = p.execute(\"9y\");\n      rv2.ok.should.eql(true);\n      rv2.value[0].should.eql(\"9y\");\n      // consumes either \"49\" or nothing:\n      const rv3 = p.execute(\"49y\");\n      rv3.ok.should.eql(false);\n    });\n  });\n\n  it(\"check\", () => {\n    const p = pr.check(\"hello\");\n    const m = p.execute(\"hello\");\n    m.ok.should.eql(true);\n    m.state.pos.should.eql(0);\n    m.value.should.eql(\"hello\");\n  });\n\n  it(\"parser.check\", () => {\n    const p = pr(\"hello\").check();\n    const m = p.execute(\"hello\");\n    m.ok.should.eql(true);\n    m.state.pos.should.eql(0);\n    m.value.should.eql(\"hello\");\n  });\n\n  it(\"check within a sequence\", () => {\n    const p = pr([ \"hello\", pr.check(\"there\"), \"th\" ]);\n    const m = p.execute(\"hellothere\");\n    m.ok.should.eql(true);\n    m.state.pos.should.eql(7);\n    m.value.should.eql([ \"hello\", \"there\", \"th\" ]);\n    (() => p.run(\"helloth\")).should.throw(/there/);\n  });\n\n  it(\"not\", () => {\n    const p = pr.not(\"hello\");\n    const m = p.execute(\"cat\");\n    m.state.pos.should.eql(0);\n    m.value.should.eql(\"\");\n    (() => p.run(\"hello\")).should.throw(/hello/);\n  });\n\n  it(\"parser.not\", () => {\n    const p = pr.string(\"hello\").not();\n    const m = p.execute(\"cat\");\n    m.state.pos.should.eql(0);\n    m.value.should.eql(\"\");\n    (() => p.run(\"hello\")).should.throw(/hello/);\n  });\n});\n"]}