{"version":3,"sources":["../../src/packrattle/priority_queue.js"],"names":[],"mappings":"AAAA,YAAY,CAAC;;;;;;;;;;AAEb,IAAI,GAAG,GAAG,CAAC,CAAC;AACZ,IAAI,KAAK,GAAG,CAAC,CAAC;;;;;;;;;IAQO,aAAa;AACrB,WADQ,aAAa,GAClB;0BADK,aAAa;;AAE9B,QAAI,CAAC,KAAK,GAAG,EAAE,CAAC;GACjB;;eAHkB,aAAa;;WAKzB,mBAAG;AACR,aAAO,IAAI,CAAC,KAAK,CAAC,KAAK,EAAE,CAAC,OAAO,EAAE,CAAC;KACrC;;;WAWI,iBAAG;AACN,UAAI,CAAC,KAAK,GAAG,EAAE,CAAC;KACjB;;;WAEE,eAAG;AACJ,UAAI,CAAC,KAAK,EAAE,CAAC;AACb,UAAI,IAAI,CAAC,KAAK,CAAC,MAAM,IAAI,CAAC,EAAE,MAAM,IAAI,KAAK,CAAC,gBAAgB,CAAC,CAAC;AAC9D,aAAO,IAAI,CAAC,KAAK,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC;KAC9B;;;;;;;;;WAOE,aAAC,IAAI,EAAE,QAAQ,EAAE,SAAS,EAAE;AAC7B,UAAM,GAAG,GAAG,EAAE,IAAI,EAAJ,IAAI,EAAE,QAAQ,EAAR,QAAQ,EAAE,CAAC;AAC/B,UAAI,SAAS,EAAE,GAAG,CAAC,SAAS,GAAG,SAAS,CAAC;;;AAGzC,UAAI,IAAI,CAAC,KAAK,CAAC,MAAM,IAAI,CAAC,IAAI,QAAQ,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,QAAQ,EAAE;AACnF,YAAI,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;AACrB,eAAO;OACR;AACD,UAAI,CAAC,SAAS,CAAC,CAAC,EAAE,IAAI,CAAC,KAAK,CAAC,MAAM,EAAE,GAAG,CAAC,CAAC;KAC3C;;;WAEQ,mBAAC,IAAI,EAAE,KAAK,EAAE,GAAG,EAAE;AAC1B,UAAI,IAAI,IAAI,KAAK,EAAE;;AAEjB,eAAO,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,IAAI,EAAE,CAAC,EAAE,GAAG,CAAC,CAAC;OACxC;AACD,UAAM,CAAC,GAAG,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,KAAK,GAAG,IAAI,CAAA,GAAI,CAAC,CAAC,CAAC;AAChD,UAAI,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,QAAQ,IAAI,GAAG,CAAC,QAAQ,EAAE;AAC1C,YAAI,CAAC,SAAS,CAAC,IAAI,EAAE,CAAC,EAAE,GAAG,CAAC,CAAC;OAC9B,MAAM;AACL,YAAI,CAAC,SAAS,CAAC,CAAC,GAAG,CAAC,EAAE,KAAK,EAAE,GAAG,CAAC,CAAC;OACnC;KACF;;;;;WAGI,iBAAG;AACN,aAAO,IAAI,EAAE;AACX,YAAI,IAAI,CAAC,KAAK,CAAC,MAAM,IAAI,CAAC,EAAE,OAAO;qBACG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC;YAA/D,IAAI,UAAJ,IAAI;YAAE,QAAQ,UAAR,QAAQ;YAAE,SAAS,UAAT,SAAS;;AACjC,YAAI,CAAC,SAAS,IAAI,SAAS,EAAE,EAAE,OAAO;AACtC,YAAI,CAAC,KAAK,CAAC,GAAG,EAAE,CAAC;OAClB;KACF;;;SAzDS,eAAG;AACX,aAAO,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC;KAC1B;;;SAEU,eAAG;AACZ,UAAI,CAAC,KAAK,EAAE,CAAC;AACb,aAAO,IAAI,CAAC,KAAK,CAAC,MAAM,IAAI,CAAC,CAAC;KAC/B;;;SAhBkB,aAAa;;;qBAAb,aAAa","file":"priority_queue.js","sourcesContent":["\"use strict\";\n\nlet top = 0;\nlet total = 0;\n\n/*\n * a priority queue, which stores an item with an associated priority\n * (number). higher numbers are bumped up ahead of lower ones.\n * for our internal array representation, the tail of the array is the head\n * of the queue.\n */\nexport default class PriorityQueue {\n  constructor() {\n    this.queue = [];\n  }\n\n  inspect() {\n    return this.queue.slice().reverse();\n  }\n\n  get length() {\n    return this.queue.length;\n  }\n\n  get isEmpty() {\n    this._trim();\n    return this.queue.length == 0;\n  }\n\n  clear() {\n    this.queue = [];\n  }\n\n  get() {\n    this._trim();\n    if (this.queue.length == 0) throw new Error(\"Queue is empty\");\n    return this.queue.pop().item;\n  }\n\n  /*\n   * add a job to the queue, at a given priority.\n   * if `condition` is given, it must be a function that returns true or false.\n   * if it returns false, the item will be skipped on `get()`.\n   */\n  put(item, priority, condition) {\n    const job = { item, priority };\n    if (condition) job.condition = condition;\n\n    // most of the time, the new job will be highest priority.\n    if (this.queue.length == 0 || priority > this.queue[this.queue.length - 1].priority) {\n      this.queue.push(job);\n      return;\n    }\n    this._putRange(0, this.queue.length, job);\n  }\n\n  _putRange(left, right, job) {\n    if (left >= right) {\n      // end of line.\n      return this.queue.splice(left, 0, job);\n    }\n    const n = left + Math.floor((right - left) / 2);\n    if (this.queue[n].priority >= job.priority) {\n      this._putRange(left, n, job);\n    } else {\n      this._putRange(n + 1, right, job);\n    }\n  }\n\n  // remove dead entries from the head of the queue.\n  _trim() {\n    while (true) {\n      if (this.queue.length == 0) return;\n      const { item, priority, condition } = this.queue[this.queue.length - 1];\n      if (!condition || condition()) return;\n      this.queue.pop();\n    }\n  }\n}\n"]}